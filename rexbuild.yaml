$engine: 3
$onesync: on
name: REX RedM Build
version: 1.0.0
author: RexShack
description: REX RedM Server Build (RSG)

tasks:
  #  Download Base Files
  - action: download_github
    src: https://github.com/RexShackGaming/txAdminRecipe
    ref: main
    dest: ./tmp/REXTemp

  - action: move_path
    src: ./tmp/REXTemp/server.cfg
    dest: ./server.cfg

  - action: move_path
    src: ./tmp/REXTemp/myLogo.png
    dest: ./myLogo.png

  # Prepare Database
  - action: connect_database
  - action: query_database
    file: ./tmp/REXTemp/rexcore.sql

  # Downloading Standalone Resources  
  - action: download_github
    src: https://github.com/citizenfx/cfx-server-data
    subpath: resources
    dest: ./resources/[cfx-default]

  - action: download_file
    path: ./tmp/files/oxmysql.zip
    url: https://github.com/CommunityOx/oxmysql/releases/latest/download/oxmysql.zip
  - action: unzip
    dest: ./resources/[standalone]
    src: ./tmp/files/oxmysql.zip
    
  - action: download_github
    dest: ./resources/[standalone]/ox_lib
    ref: main
    src: https://github.com/Rexshack-RedM/ox_lib

  - action: download_github
    dest: ./resources/[standalone]/PolyZone
    ref: main
    src: https://github.com/RexShack/PolyZone

  - action: download_github
    dest: ./resources/[standalone]/pma-voice
    ref: main
    src: https://github.com/AvarianKnight/pma-voice

  - action: download_github
    dest: ./resources/[standalone]/weathersync
    ref: main
    src: https://github.com/RexShack/weathersync

  - action: download_github
    dest: ./resources/[standalone]/xsound
    ref: master
    src: https://github.com/RexShack/xsound

  - action: download_github
    dest: ./resources/[standalone]/interact-sound 
    ref: main
    src: https://github.com/Rexshack-RedM/interact-sound 

  - action: download_github
    dest: ./resources/[standalone]/menu_base
    ref: main
    src: https://github.com/Rexshack-RedM/menu_base

  - action: download_github
    dest: ./resources/[standalone]/ox_target
    ref: main
    src: https://github.com/Rexshack-RedM/ox_target

  - action: download_github
    dest: ./resources/[standalone]/ox_doorlock
    ref: main
    src: https://github.com/Rexshack-RedM/ox_doorlock

  - action: waste_time # prevent github throttling
    seconds: 10

  # Download RSGCore resources

  - action: download_github
    src: https://github.com/Rexshack-RedM/rsg-core
    ref: main
    dest: ./resources/[framework]/rsg-core

  - action: download_github
    src: https://github.com/Rexshack-RedM/rsg-inventory
    ref: main
    dest: ./resources/[framework]/rsg-inventory

  - action: download_github
    src: https://github.com/Rexshack-RedM/rsg-multicharacter
    ref: main
    dest: ./resources/[framework]/rsg-multicharacter

  - action: download_github
    src: https://github.com/Rexshack-RedM/rsg-appearance
    ref: main
    dest: ./resources/[framework]/rsg-appearance

  - action: download_github
    src: https://github.com/Rexshack-RedM/rsg-wardrobe
    ref: main
    dest: ./resources/[framework]/rsg-wardrobe

  - action: download_github
    src: https://github.com/Rexshack-RedM/rsg-medic
    ref: main
    dest: ./resources/[framework]/rsg-medic

  - action: download_github
    src: https://github.com/Rexshack-RedM/rsg-lawman
    ref: main
    dest: ./resources/[framework]/rsg-lawman

  - action: download_github
    src: https://github.com/Rexshack-RedM/rsg-prison
    ref: main
    dest: ./resources/[framework]/rsg-prison

  - action: download_github
    src: https://github.com/Rexshack-RedM/rsg-doorlock
    ref: main
    dest: ./resources/[framework]/rsg-doorlock

  - action: waste_time # prevent github throttling
    seconds: 10

  - action: download_github
    src: https://github.com/Rexshack-RedM/rsg-banking
    ref: main
    dest: ./resources/[framework]/rsg-banking

  - action: download_github
    src: https://github.com/Rexshack-RedM/rsg-spawn
    ref: main
    dest: ./resources/[framework]/rsg-spawn

  - action: download_github
    src: https://github.com/Rexshack-RedM/rsg-weapons
    ref: main
    dest: ./resources/[framework]/rsg-weapons

  - action: download_github
    src: https://github.com/Rexshack-RedM/rsg-ammo
    ref: main
    dest: ./resources/[framework]/rsg-ammo

  - action: download_github
    src: https://github.com/Rexshack-RedM/rsg-shops
    ref: main
    dest: ./resources/[framework]/rsg-shops

  - action: download_github
    src: https://github.com/Rexshack-RedM/rsg-radialmenu
    ref: main
    dest: ./resources/[framework]/rsg-radialmenu

  - action: download_github
    src: https://github.com/Rexshack-RedM/rsg-essentials
    ref: main
    dest: ./resources/[framework]/rsg-essentials

  - action: waste_time # prevent github throttling
    seconds: 10

  - action: download_github
    src: https://github.com/Rexshack-RedM/rsg-telegram
    ref: main
    dest: ./resources/[framework]/rsg-telegram

  - action: download_github
    src: https://github.com/Rexshack-RedM/rsg-horses
    ref: main
    dest: ./resources/[framework]/rsg-horses

  - action: download_github
    src: https://github.com/Rexshack-RedM/rsg-hud
    ref: main
    dest: ./resources/[framework]/rsg-hud

  - action: download_github
    dest: ./resources/[framework]/rsg-menubase
    ref: main
    src: https://github.com/Rexshack-RedM/rsg-menubase

  - action: download_github
    dest: ./resources/[framework]/rsg-playerinfo
    ref: main
    src: https://github.com/Rexshack-RedM/rsg-playerinfo

  - action: download_github
    dest: ./resources/[framework]/rsg-bossmenu
    ref: main
    src: https://github.com/Rexshack-RedM/rsg-bossmenu

  - action: download_github
    dest: ./resources/[framework]/rsg-gangmenu
    ref: main
    src: https://github.com/Rexshack-RedM/rsg-gangmenu

  - action: waste_time # prevent github throttling
    seconds: 10

  - action: download_github
    dest: ./resources/[framework]/rsg-npcs
    ref: main
    src: https://github.com/Rexshack-RedM/rsg-npcs

  - action: download_github
    dest: ./resources/[framework]/rsg-canteen
    ref: main
    src: https://github.com/Rexshack-RedM/rsg-canteen

  - action: download_github
    dest: ./resources/[framework]/rsg-barbers
    ref: main
    src: https://github.com/Rexshack-RedM/rsg-barbers

  - action: download_github
    dest: ./resources/[framework]/rsg-bathing
    ref: main
    src: https://github.com/Rexshack-RedM/rsg-bathing

  - action: download_github
    dest: ./resources/[framework]/rsg-lockpick
    ref: main
    src: https://github.com/Rexshack-RedM/rsg-lockpick

  - action: download_github
    dest: ./resources/[framework]/rsg-adminmenu
    ref: main
    src: https://github.com/Rexshack-RedM/rsg-adminmenu

  - action: download_github
    dest: ./resources/[framework]/rsg-animations
    ref: main
    src: https://github.com/Rexshack-RedM/rsg-animations

  - action: download_github
    dest: ./resources/[framework]/rsg-multijob
    ref: main
    src: https://github.com/Rexshack-RedM/rsg-multijob

  - action: download_github
    dest: ./resources/[framework]/rsg-consume
    ref: main
    src: https://github.com/Rexshack-RedM/rsg-consume

  - action: download_github
    dest: ./resources/[framework]/rsg-fishing
    ref: main
    src: https://github.com/Rexshack-RedM/rsg-fishing

  - action: waste_time # prevent github throttling
    seconds: 10

  - action: download_github
    dest: ./resources/[framework]/rsg-weaponcomp
    ref: main
    src: https://github.com/Rexshack-RedM/rsg-weaponcomp

  - action: download_github
    dest: ./resources/[framework]/rsg-loading
    ref: main
    src: https://github.com/Rexshack-RedM/rsg-loading

  # Download Rexshack MapMod resources

  - action: download_github
    src: https://github.com/Rexshack-RedM/redm-ipls
    ref: main
    dest: ./resources/[mapmods]/redm-ipls

  - action: download_github
    src: https://github.com/Rexshack-RedM/redm-ymaps
    ref: main
    dest: ./resources/[mapmods]/redm-ymaps
    
  # Download REX resources
  
  - action: download_github
    src: https://github.com/RexShackGaming/rex-chat
    ref: main
    dest: ./resources/[rexscripts]/rex-chat
    
  - action: download_github
    src: https://github.com/RexShackGaming/rex-blackmarket
    ref: main
    dest: ./resources/[rexscripts]/rex-blackmarket
    
  - action: download_github
    src: https://github.com/RexShackGaming/rex-butcher
    ref: main
    dest: ./resources/[rexscripts]/rex-butcher
    
  - action: download_github
    src: https://github.com/RexShackGaming/rex-campfire
    ref: main
    dest: ./resources/[rexscripts]/rex-campfire
    
  - action: download_github
    src: https://github.com/RexShackGaming/rex-codes
    ref: main
    dest: ./resources/[rexscripts]/rex-codes
    
  - action: download_github
    src: https://github.com/RexShackGaming/rex-cooking
    ref: main
    dest: ./resources/[rexscripts]/rex-cooking
    
  - action: waste_time # prevent github throttling
    seconds: 10
    
  # Remove and Add new items.lua
  - action: remove_path
    path: ./resources/[framework]/rsg-core/shared/items.lua
    
  - action: move_path
    src: ./tmp/REXTemp/items.lua
    dest: ./resources/[framework]/rsg-core/shared/items.lua
    
  # Remove and Add new images folder
  - action: remove_path
    path: ./resources/[framework]/rsg-inventory/html/images
    
  - action: move_path
    src: ./tmp/REXTemp/images
    dest: ./resources/[framework]/rsg-inventory/html/images
    
  # Remove Old Chat
  - action: remove_path
    path: ./resources/[cfx-default]/[gameplay]/chat

  # Clean up
  - action: remove_path
    path: ./tmp
